{% extends "teacher-base.html" %}
{% load staticfiles %}
    {% block modals %}
	<!-- Modal -->
	<div class="modal fade" id="activityChoice" tabindex="-1" role="dialog" data-backdrop="static">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-body">
	      	<label>Activity</label>
	      	<select id="activitySelector" class="form-control">
				<option value="choose" href="#">Choose an activity...</option>
{% for act in activities %}
				<option value="{{act.pk}}" href="#">{{ act.name }}</option>
{% endfor %}
			</select>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
	        <button type="button" class="btn btn-primary" onclick="submitActivityChoice()">Confirm</button>
	      </div>
	    </div>
	  </div>
	</div>
    {% endblock %}
    {% block content %}

	<style>
	#graph {
		-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none;
	    -moz-user-select: none; -ms-user-select: none; user-select: none;
	}
	#graph.hover { cursor: pointer!important; }
	.contextMenu {
	    position: absolute; width: 70px; z-index: 99999;
	    border: solid 1px #BBB; border-radius: 5px; background: #FFF;
	    padding: 0px; margin: 0px; display: none; }
	.contextMenu LI { list-style: none; padding: 0px; margin: 0px; }
	.contextMenu A {
	    color: #333; text-decoration: none; font-size: 12px;
	    display: block; line-height: 20px; height: 20px;
	    background-position: 6px center; background-repeat: no-repeat;
	    outline: none; padding: 1px 5px; }
	.contextMenu LI.hover A { color: #FFF; background-color: #3399FF; }
	</style>

    <div class="row">
    	<div class="col-lg-12">
    		{% if scenario.id %}
			<h1 class="page-header">Editing Scenario '{{ scenario.name }}'</h1>
			{% else %}
			<h1 class="page-header">Creating New Scenario</h1>
			{% endif %}
		</div>
	</div>

	<button type="button" class="btn btn-primary pull-right" id="SAVE" onclick="saveScenario()">Save</button>
            <div class="row">
	<form id="scenarioForm" action="{{ action }}" method="post">{% csrf_token %}
	    {{ form.as_p }}
	</form>


	<div id="container" class="col-md-12" style="overflow: scroll; overflow-y: hidden; padding: 0; border:solid 1px #CCC; margin-top:10px; background:#FAFAFA">
		<div id="graph"></div>
	</div>

	<ul id="menuContext" class="contextMenu">
	    <li><a name="edit">Edit</a></li>
	    <li><a name="connect">Connect</a></li>
	</ul>


    {% endblock %}
    {% block extra-scripts %}
    <!--<script src="/static/js/snap/dist/snap.svg-min.js"></script>-->
	<!--<script src="http://medialize.github.io/jQuery-contextMenu/src/jquery.contextMenu.js" type="text/javascript"></script>-->
	<!--<script src="{% static 'js/graph.js' %}"></script>-->

	<script src="{% static 'js/raphael.js' %}"></script>
	<script src="{% static 'js/raphael.json.js' %}"></script>
	<script src="{% static 'grapheditor/init.js' %}"></script>
	<script src="{% static 'grapheditor/modeSave.js' %}"></script>
	<script src="{% static 'grapheditor/modeLoad.js' %}"></script>
	<script src="{% static 'grapheditor/modeConnect.js' %}"></script>
	<script src="{% static 'grapheditor/modeErase.js' %}"></script>
	<script src="{% static 'grapheditor/modeMove.js' %}"></script>
	<script src="{% static 'grapheditor/modeAdd.js' %}"></script>
	<script src="{% static 'grapheditor/modeEdit.js' %}"></script>
	<script>
	var dbActivities = {};
	var oldScenario = null;

    //Building a dictionary of activities
    {% for act in activities %}
        dbActivities["{{ act.pk }}"] = ["{{ act.name|escapejs }}", "{{ act.type|escapejs }}", "{{ act.source|escapejs }}"];
    {% endfor %}

    {% if scenario.id %}
		oldScenario = "{{ scenario.raphaelJson }}";
	{% endif %}
	</script>


    {% endblock %}
